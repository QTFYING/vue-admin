# 支付宝接入

## 支付宝所有支付方式支持度

| 场景     | 对应支付宝产品       | 交互形态                         | 我们的 SDK 支持策略                   |
| -------- | -------------------- | -------------------------------- | ------------------------------------- |
| 手机网页 | 手机网站支付 (Wap)   | 跳转支付宝 APP 或 H5 收银台      | ✅ 核心支持 (Form 提交或 URL 跳转)    |
| PC 网页  | 电脑网站支付 (Page)  | 跳转支付宝 PC 收银台 (扫码/登录) | ✅ 核心支持 (Form 提交)               |
| APP      | APP 支付             | 唤起支付宝 APP                   | ✅ 核心支持 (通过 UniApp/Bridge)      |
| 小程序   | 支付宝小程序支付     | 唤起小程序收银台                 | ✅ 核心支持 (JSAPI)                   |
| PC 扫码  | 当面付 (扫码模式)    | 页面展示二维码，用户扫码         | ✅ 支持 (渲染二维码，类似微信 Native) |
| 其他     | 条码付、声波付、刷脸 | 需要硬件配合                     | ❌ 不支持 (超纲)                      |
| 能力     | 周期扣款、预授权     | 只是参数不同                     | ⚠️ 作为参数支持 (在 Adapter 透传)     |

## 如何规划Adapter和Invoker

支付宝和微信最大的区别在于：微信几乎都是 JSON 交互，而支付宝的老接口（PC/Wap）非常喜欢返回 HTML Form 表单。因此，我们需要引入一个新的 Invoker 概念：FormInvoker。

### 规划图谱

- Mode A: SDK 唤起模式 (App / 小程序)
  - 后端返回：一个很长的签名字符串 (orderStr / tradeNO)。
  - Invoker：UniAppInvoker 或 BridgeInvoker。
  - 动作：uni.requestPayment({ provider: 'alipay', orderInfo: '...' })。

- Mode B: 页面跳转模式 (PC / Wap)
  - 后端返回：一段 `<form action="...">...</form><script>submit()</script>` 代码。
  - Invoker：FormInvoker (新增)。
  - 动作：将 HTML 插入 DOM，自动 submit，浏览器跳转。

- Mode C: 二维码模式 (当面付)
  - 后端返回：一个 URL (qr_code)。

Invoker：WebInvoker。

动作：渲染二维码图片。
